{"ast":null,"code":"import { csrfFetch } from \"./csrf\";\nconst GET_COMMENTS = \"/api/GETCOMMENTS\";\nconst ADD_COMMENT = \"/api/ADDCOMMENT\";\nconst DELETE_COMMENT = \"/api/DELETECOMMENT\";\n\nconst getComments = comments => ({\n  type: GET_COMMENTS,\n  comments\n});\n\nconst addComment = comment => ({\n  type: ADD_COMMENT,\n  comment\n});\n\nconst deleteComment = id => ({\n  type: DELETE_COMMENT,\n  id\n});\n\nexport const getAllComments = songId => async dispatch => {\n  const response = await csrfFetch(`/api/songs/${songId}/comments`, {\n    method: \"GET\"\n  });\n\n  if (response.ok) {\n    const data = await response.json();\n    dispatch(getComments(data));\n  }\n};\nexport const createComment = comments => async dispatch => {\n  const {\n    userId,\n    songId,\n    comment\n  } = comments;\n  const response = await csrfFetch(`/api/songs/${songId}`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      userId,\n      songId,\n      body: comment\n    })\n  });\n\n  if (response.ok) {\n    const data = await response.json();\n    dispatch(addComment(data));\n    return data;\n  }\n};\nexport const removeComment = comments => async dispatch => {\n  const {\n    songId,\n    id\n  } = comments;\n  console.log(comment, \"----------------------------------------------\");\n  const response = await csrfFetch(`/api/songs/${songId}/comments/${id}`, {\n    method: 'DELETE'\n  });\n\n  if (response.ok) {\n    dispatch(deleteComment(id));\n  }\n};\nconst initialState = {};\n\nconst commentReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  let newState;\n\n  switch (action.type) {\n    case GET_COMMENTS:\n      newState = { ...state\n      };\n      action.comments.forEach(comment => newState[comment.id] = comment);\n      return newState;\n\n    case ADD_COMMENT:\n      return { ...state,\n        [action.comment.id]: action.comment\n      };\n\n    case DELETE_COMMENT:\n      console.log(action, \"this delete reducer\");\n      return delete { ...state,\n        [action.id]: action.id\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default commentReducer;","map":{"version":3,"names":["csrfFetch","GET_COMMENTS","ADD_COMMENT","DELETE_COMMENT","getComments","comments","type","addComment","comment","deleteComment","id","getAllComments","songId","dispatch","response","method","ok","data","json","createComment","userId","headers","body","JSON","stringify","removeComment","console","log","initialState","commentReducer","state","action","newState","forEach"],"sources":["/home/jasontang/noiseNimbus/frontend/src/store/comment.js"],"sourcesContent":["import { csrfFetch } from \"./csrf\";\n\nconst GET_COMMENTS = \"/api/GETCOMMENTS\";\nconst ADD_COMMENT = \"/api/ADDCOMMENT\";\nconst DELETE_COMMENT = \"/api/DELETECOMMENT\";\n\nconst getComments = (comments) => ({\n    type: GET_COMMENTS,\n    comments\n})\n\nconst addComment = (comment) => ({\n    type: ADD_COMMENT,\n    comment\n})\n\nconst deleteComment = (id) => ({\n    type: DELETE_COMMENT,\n    id\n})\n\nexport const getAllComments = (songId) => async (dispatch) => {\n    const response = await csrfFetch(`/api/songs/${songId}/comments`, {\n        method: \"GET\"\n    });\n\n    if (response.ok) {\n        const data = await response.json();\n        dispatch(getComments(data));\n    }\n};\n\nexport const createComment = (comments) => async (dispatch) => {\n    const { userId, songId, comment} = comments;\n    const response = await csrfFetch(`/api/songs/${songId}`, {\n        method: \"POST\",\n        headers: {\"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n            userId,\n            songId,\n            body: comment\n        })\n    });\n    if (response.ok) {\n        const data = await response.json();\n        dispatch(addComment(data));\n        return data;\n    }\n}\n\nexport const removeComment = (comments) => async(dispatch) => {\n    const {songId, id} = comments\n    console.log(comment, \"----------------------------------------------\")\n    const response = await csrfFetch(`/api/songs/${songId}/comments/${id}`, {\n        method: 'DELETE'\n    });\n\n    if (response.ok) {\n        dispatch(deleteComment(id))\n    }\n}\n\n\nconst initialState = {};\n\nconst commentReducer = (state = initialState, action) => {\n    let newState;\n    switch (action.type) {\n        case GET_COMMENTS:\n            newState = {...state};\n            action.comments.forEach(comment => (newState[comment.id] = comment));\n            return newState;\n\n        case ADD_COMMENT:\n            return { ...state, [action.comment.id]: action.comment };\n\n        case DELETE_COMMENT:\n            console.log(action, \"this delete reducer\")\n            return delete { ...state, [action.id]: action.id };\n\n        default:\n            return state;\n    }\n}\n\nexport default commentReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}